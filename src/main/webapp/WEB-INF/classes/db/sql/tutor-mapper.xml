<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>

	<entry key="selectTutorInfo">
	
	   SELECT 
		   	MEM_NO
	        , TT_NAME
	        , TT_PHONE
	        , TT_EMAIL
	        , INTRODUCE
	        , PUB_PHONE
	        , TT_PROFILE
	    FROM TUTOR
	    WHERE MEM_NO = ?

	</entry>
	
	<!-- 로그인한 튜터 클래스 개수  -->
	<entry key="selectClassCount">
		
		SELECT COUNT(*) "count"
		FROM CLASS
		WHERE MEM_NO =?
	</entry>
	
	<!-- 클래스 리스트 조회 -->
	<entry key="selectClassList">
	
	 SELECT *
	 FROM
	  (	
		SELECT ROWNUM RNUM, A.*
		FROM	
			(
			 SELECT 
					 C.CL_NO
					,G.CT_NAME
					,D.CT_DNAME
					,T.TT_NAME
					,CL_NAME
					,C.ENROLL_DATE
					,C.CL_STATUS
					,CL_REFUSE
					
				FROM CLASS C
				JOIN CATEGORY G USING (CT_NO)
				JOIN DCATEGORY D USING (CT_DNO)
				JOIN TUTOR T USING (MEM_NO)
				WHERE MEM_NO= ?
			    ORDER BY CL_NO DESC
			)A
	  )	
	WHERE RNUM BETWEEN ?   AND ?
	</entry>
	

	
	<!-- 카테고리 대분류 조회 -->	
	<entry key="selectCategoryList">
		SELECT CT_NO
			  ,CT_NAME
		FROM  CATEGORY

	</entry>
	<!-- 세부카테고리 조회 -->
	<entry key="selectDcategoryList">
		SELECT CT_DNO
		      ,CT_NO
		      ,CT_DNAME
		 FROM DCATEGORY     

	</entry>		

	<!-- 튜터 프로필 수정 -->
	<entry key="updateTutorProfile">
	 	UPDATE TUTOR
	 	  SET  TT_NAME =?
	 	  	  , TT_PHONE =?
	 	  	  , TT_EMAIL =?
	 	  	  , INTRODUCE= ?
	 	  	  , PUB_PHONE= ?
	 	  	  , TT_PROFILE =?
	 	  	  , MODIFY_DATE = SYSDATE
	 	WHERE MEM_NO = ?

	</entry>
	
	<!-- 튜터 닉네임 중복체크 -->
	<entry key="nickCheck">
		SELECT
			   COUNT(*) "COUNT"
		  FROM TUTOR
		WHERE TT_NAME = ? 
		 
	</entry>

	
	
	<entry key="insertTutor">
		INSERT
		  INTO TUTOR
		  (
			    MEM_NO
			  , TT_NAME
			  , TT_PHONE
			  , TT_EMAIL
			  , INTRODUCE
			  , PUB_PHONE
			  , TT_PROFILE
		  )
		  VALUES
		  (
			    ?
			  , ?
			  , ?
			  , ?
			  , ?
			  , ?
			  , ?
		  )
	</entry>
	
	<!-- 튜터 등급 변경 -->
	<entry key="updateGrade">
		UPDATE MEMBER
    	   SET GRADE='2'
         WHERE MEM_NO = ? 
	</entry>
	
	<!-- 클래스 상세조회 -->
	<entry key="selectClass">
		SELECT 
	        CL_NO,
	        CT_NAME,
	        CT_DNAME,
	        TT_NAME,
	        LOCAL_NAME,
	        DISTR_NAME,
	        CL_NAME,
	        CL_ADDRESS,
	        CL_MAX,
	        CL_LEVEL,
	        START_DATE,
	        END_DATE,
	        CL_TIMES,
	        CL_SCHEDULE,
	        CL_DAY,
	        TO_CHAR(CL_PRICE, '999,999,999')"CL_PRICE",
	        CL_DETAIL,
	        CURRICULUM,
	        REFUNDPOLICY,
	        CL_SUPPLIES,
	        KEYWORD,
	        C.ENROLL_DATE,
	        CL_STATUS,
	        CL_THUMB,
	        INTRODUCE
	   FROM CLASS C
	   JOIN CATEGORY G USING (CT_NO)
	   JOIN DCATEGORY D USING (CT_DNO)
	   JOIN TUTOR T USING (MEM_NO)
	   JOIN LOCATION USING (LOCAL_CODE)
	   JOIN DISTRICT USING (DISTR_CODE)
	  WHERE CL_NO =?
   
		
	
	</entry>
	
	<!-- 스케줄조회 -->
	<entry key="selectSchedule">
	SELECT SCH_NO
		  ,CL_NO
		  ,SESSION_NO
		  ,START_TIME
		  ,END_TIME
	FROM SCHEDULE	
	WHERE CL_NO = ?  
	</entry>
	
	<!-- 클래스 판매중단처리 -->
	<entry key="stopClassUpdate">
	 UPDATE CLASS
	    SET END_DATE = TO_CHAR(SYSDATE,'YYYY/MM/DD')
	    	,UPDATE_DATE = SYSDATE
	    	,CL_STATUS = 3
	
	  WHERE CL_NO =?
	

	</entry>
	
	<!-- 클래스등록 -->
	<entry key="insertClass">
	INSERT 
			 INTO CLASS
			    (
			     CL_NO
			    , CT_NO 
			    , CT_DNO
			    , MEM_NO
			    , LOCAL_CODE 
			    , DISTR_CODE
			    , CL_NAME 
			    , CL_ADDRESS
			    , CL_MAX 
			    , CL_LEVEL
			    , CL_TIMES 
			    , CL_SCHEDULE
			    , CL_DAY 
			    , CL_PRICE 
			    , CL_DETAIL 
			    , CURRICULUM
			    , REFUNDPOLICY 
			    , CL_SUPPLIES
			    , KEYWORD
			    , ENROLL_DATE 
			    , CL_STATUS  
			    , CL_THUMB 
			    )
			VALUES
			 (
			  SEQ_CLNO.NEXTVAL,
			  ?,
			  (SELECT CT_DNO
			  FROM DCATEGORY
			  WHERE CT_DNAME = ?),  
			  ?,
			  (SELECT LOCAL_CODE
			  FROM LOCATION
			  WHERE LOCAL_NAME = ?),
			  (SELECT DISTR_CODE
			  FROM DISTRICT
			  WHERE DISTR_NAME = ?),
			  ?,
			  ?,
			  ?,
			  ?,
			  ?,
			  ?,
			  ?,
			  ?,
			  ?,
			  ?,
			  ?,
			  ?,
			  ?,
			  SYSDATE,
			  0,
			  ?
			  
			)

	</entry>
	
	<!-- 클래스 첨부파일등록 -->
	<entry key="insertClassAttachment">
	
	  INSERT 
	     INTO ATTACHMENT
	     (
			FILE_NO
		  ,	ORIGIN_NAME
		  , CHANGE_NAME
		  , FILE_PATH
		  , UPLOAD_DATE
		  , FILE_LEVEL
		  , REF_TYPE
		  , REF_NO
	     
	     )
	     VALUES
	     (
	      SEQ_ATNO.NEXTVAL
	      ,?
	      ,?
	      ,?
	      ,SYSDATE
	      ,?
	      ,?
	      ,SEQ_CLNO.CURRVAL

	     )
	     
	
	
	</entry>
	
	<!-- 클래스 첨부파일 조회 -->
	<entry key="selectAttachment">
		SELECT 
				FILE_NO
			   ,ORIGIN_NAME
			   ,CHANGE_NAME
			   ,FILE_PATH
			   ,REF_NO
	    FROM ATTACHMENT
	    WHERE REF_NO = ?
	       

	</entry>
	
	<!-- 클래스 등록시 스케줄 등록 -->
	<entry key="insertSchedule">
	
	INSERT 
		INTO SCHEDULE
		         (SCH_NO
		        , CL_NO
		        , SESSION_NO
		        , START_TIME
		        , END_TIME
		       	, CLS_HOUR
		        )
		VALUES 
		        ( 
		          SEQ_SCHNO.NEXTVAL
		          ,	SEQ_CLNO.CURRVAL
		          , ?
		          , ?
		          , ?
		          ,(SELECT ROUND((TO_DATE(?, 'HH24:MI') - TO_DATE(?, 'HH24:MI')) * 24, 2)
           			 FROM dual)
  
		        
		            )
  
	</entry>
	<entry key="updateClass">
		   UPDATE CLASS
       		  SET
            	 CT_NO = ?
			    , CT_DNO = (SELECT CT_DNO
                            FROM DCATEGORY
                            WHERE CT_DNAME = ?)
			    , LOCAL_CODE =  (SELECT LOCAL_CODE
                                  FROM LOCATION
                                  WHERE LOCAL_NAME = ?)
			    , DISTR_CODE = (SELECT DISTR_CODE
                                FROM DISTRICT
                                  WHERE DISTR_NAME = ?)
			    , CL_NAME  = ?
			    , CL_ADDRESS = ?
			    , CL_MAX = ?
			    , CL_LEVEL = ?
			    , CL_TIMES = ?
			    , CL_SCHEDULE = ?
			    , CL_DAY = ?
			    , CL_PRICE = ?
			    , CL_DETAIL = ?
			    , CURRICULUM = ?
			    , REFUNDPOLICY = ?
			    , CL_SUPPLIES = ?
			    , KEYWORD = ?
			    , UPDATE_DATE = SYSDATE
			    , CL_STATUS = 0
			    , CL_THUMB = ?
	  WHERE  CL_NO = ?		    
		
	
	
	
	</entry>
	
	<entry key="updateAttachment">
	
	  	UPDATE ATTACHMENT
	  	SET ORIGIN_NAME = ?
	  	   ,CHANGE_NAME = ?
	  	   ,FILE_PATH =?
		   ,UPLOAD_DATE = SYSDATE
		WHERE FILE_NO =?	
	
	</entry>
	<entry key="insertNewAttachment">
	    INSERT 
	     INTO ATTACHMENT
	     (
			FILE_NO
		  ,	ORIGIN_NAME
		  , CHANGE_NAME
		  , FILE_PATH
		  , UPLOAD_DATE
		  , FILE_LEVEL
		  , REF_TYPE
		  , REF_NO
	     
	     )
	     VALUES
	     (
	      SEQ_ATNO.NEXTVAL
	      ,?
	      ,?
	      ,?
	      ,SYSDATE
	      ,?
	      ,?
	      ,?

	     )
	     
	</entry>
	
	<entry key="deleteSchedule">
	   	DELETE
	   	FROM SCHEDULE
	    WHERE CL_NO =?

	</entry>
	<entry key="insertNewSchedule">
	
	INSERT 
		INTO SCHEDULE
		         (SCH_NO
		        , CL_NO
		        , SESSION_NO
		        , START_TIME
		        , END_TIME
		       	, CLS_HOUR
		        )
		VALUES 
		        ( 
		          SEQ_SCHNO.NEXTVAL
		          ,	?
		          , ?
		          , ?
		          , ?
		          ,(SELECT ROUND((TO_DATE(?, 'HH24:MI') - TO_DATE(?, 'HH24:MI')) * 24, 2)
           			 FROM dual)
  
		        
		            )
	
	
	
	</entry>


</properties>