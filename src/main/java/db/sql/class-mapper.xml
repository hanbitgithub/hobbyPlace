<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
	<entry key="selectMainClass">
		SELECT 
		       CL_NO
		     , LOCAL_NAME
		     , DISTR_NAME
		     , SUBSTR(CL_NAME, 1, 10) || '...' "CL_NAME"
		     , TO_CHAR(CL_PRICE, '999,999,999') || '원' "CL_PRICE"
		     , CL_THUMB
		     , (SELECT AVG(RE_STAR) 
		          FROM REVIEW R
		         WHERE R.CL_NO = C.CL_NO) "STAR_AVG"
		     , (SELECT COUNT(RE_STAR) 
		          FROM REVIEW R
		         WHERE R.CL_NO = C.CL_NO) "STAR_COUNT"
		  FROM CLASS C
		  JOIN LOCATION USING(LOCAL_CODE)
		  JOIN DISTRICT ON(DESTR_CODE = DISTR_CODE)
		 WHERE CL_STATUS = 2
		 ORDER
		    BY CL_NO DESC
	</entry>
	<entry key="selectLikeClass">
		SELECT 
		       CL_NO
		     , LOCAL_NAME
		     , DISTR_NAME
		     , SUBSTR(CL_NAME, 1, 10) || '...' "CL_NAME"
		     , TO_CHAR(CL_PRICE, '999,999,999') || '원' "CL_PRICE"
		     , CL_THUMB
		     , (SELECT AVG(RE_STAR) 
		          FROM REVIEW R
		         WHERE R.CL_NO = C.CL_NO) "STAR_AVG"
		     , (SELECT COUNT(RE_STAR) 
		          FROM REVIEW R
		         WHERE R.CL_NO = C.CL_NO) "STAR_COUNT"
		     , (SELECT COUNT(*)
		          FROM "LIKE" L
		         WHERE L.CL_NO = C.CL_NO
		         GROUP BY L.CL_NO) "LIKE_COUNT"
		  FROM CLASS C
		  JOIN LOCATION USING(LOCAL_CODE)
		  JOIN DISTRICT ON(DESTR_CODE = DISTR_CODE)
		 WHERE CL_STATUS = 2
		  ORDER BY LIKE_COUNT DESC NULLS LAST
	</entry>
	<entry key="selectReviewClass">
		SELECT 
		         RE_NO
		       , SUBSTR(CONTENT, 1, 28) || '...' "CONTENT"
		       , RE_STAR
		       , CL_NO
		       , CL_NAME
		       , CL_THUMB
		  FROM REVIEW
		  JOIN CLASS USING(CL_NO)
		 WHERE CL_STATUS = 2
		   AND RE_STA = 'Y'
		 ORDER BY RE_NO DESC
	</entry>
	
	<entry key="selectClassPage">
		SELECT
		       CT_NAME
		     , CT_DNAME
		     , TT_NAME
		     , CL_NAME
		     , CL_ADDRESS
		     , CL_MAX
		     , CL_LEVEL
		     , START_DATE
		     , END_DATE
		     , CL_TIMES
		     , CL_SCHEDULE
		     , CL_DAY
		     , CL_PRICE
		     , CL_DETAIL
		     , CURRICULUM
		     , REFUNDPOLICY
		     , NVL(CL_SUPPLIES, '준비물 없음') "CL_SUPPLIES"
		     , CL_THUMB
		     , (SELECT AVG(RE_STAR) 
		          FROM REVIEW R
		         WHERE R.CL_NO = C.CL_NO) "STAR_AVG"
		     , (SELECT COUNT(RE_STAR) 
		          FROM REVIEW R
		         WHERE R.CL_NO = C.CL_NO) "STAR_COUNT"
		     , (SELECT COUNT(*)
		          FROM "LIKE" L
		         WHERE L.CL_NO = C.CL_NO
		         GROUP BY L.CL_NO) "LIKE_COUNT"
		     , TT_PROFILE
		  FROM CLASS C
		  JOIN CATEGORY USING(CT_NO)
		  JOIN DCATEGORY USING(CT_DNO)
		  JOIN TUTOR USING(MEM_NO)
		 WHERE C.CL_STATUS = 2
		   AND C.CL_NO = ?
	</entry>
	<entry key="selectClassAttachment">
		SELECT 
		       FILE_NO
		     , CHANGE_NAME
		     , FILE_PATH
		  FROM ATTACHMENT
		 WHERE REF_NO = ?
		   AND REF_TYPE = 1
		   AND STATUS = 'Y'
	</entry>
	<entry key="selectClassReview">
		SELECT
		       RE_NO
		     , CONTENT
		     , RE_STAR
		     , RE_DATE
		     , RE_UPDATE
		     , MEM_NICKNAME
		     , MEM_PROFILE
		  FROM REVIEW R
		  JOIN REGISTER USING(REG_NO)
		  JOIN MEMBER USING(MEM_NO)
		 WHERE R.CL_NO = ?
		   AND RE_STA = 'Y'
	</entry>

</properties>